# Appliquer les techniques de durcissement d'OS
# Scénario

Vous êtes analyste en cybersécurité pour yummyrecipesforme.com, un site web qui vend des recettes et des livres de cuisine. Un ancien employé a décidé d'attirer les utilisateurs vers un faux site web contenant des logiciels malveillants. 

L'ancien employé/le pirate a exécuté une attaque par force brute pour accéder à l'hébergeur du site web. Il a saisi à plusieurs reprises plusieurs mots de passe par défaut connus pour le compte administratif jusqu'à ce qu'il devine le bon. Après avoir obtenu les identifiants de connexion, il a pu accéder au panneau d'administration et modifier le code source du site web. Ils ont intégré une fonction javascript dans le code source qui invitait les visiteurs à télécharger et à exécuter un fichier lors de leur passage sur le site web. Après avoir intégré le logiciel malveillant, le pirate a modifié le mot de passe du compte administratif. Lorsque les clients téléchargent le fichier, ils sont redirigés vers une fausse version du site web qui contient le logiciel malveillant. 

Plusieurs heures après l'attaque, de nombreux clients ont envoyé un courriel au service d'assistance de yummyrecipesforme. Ils se sont plaints que le site web de l'entreprise les avait incités à télécharger un fichier pour accéder à des recettes gratuites. Les clients ont affirmé qu'après avoir exécuté le fichier, l'adresse du site web avait changé et que leurs ordinateurs personnels avaient commencé à fonctionner plus lentement.

En Réponse aux incidents, le propriétaire du site web tente de se connecter au panneau d'administration, mais n'y parvient pas, et s'adresse alors à l'hébergeur du site. Vous et d'autres analystes en cybersécurité êtes chargés d'enquêter sur cet événement de sécurité.

Pour traiter l'incident, vous créez un environnement sandbox pour observer le comportement suspect du site web. Vous exécutez l'analyseur de protocoles réseau tcpdump, puis saisissez l'URL du site web, yummyrecipesforme.com. Dès le chargement du site web, vous êtes invité à télécharger un fichier exécutable pour mettre à jour votre navigateur. Vous acceptez le téléchargement et autorisez l'exécution du fichier. Vous constatez alors que votre navigateur vous redirige vers une autre URL, greatrecipesforme.com, qui contient le logiciel malveillant.

Les journaux montrent le processus suivant :

Le navigateur lance une requête DNS : Il demande au serveur DNS l'adresse IP de l'URL yummyrecipesforme.com.

Le DNS répond avec l'adresse IP correcte.

Le navigateur lance une requête HTTP : Il demande la page web yummyrecipesforme.com en utilisant l'adresse IP envoyée par le serveur DNS.

Le navigateur lance le téléchargement du logiciel malveillant.

Le navigateur lance une requête DNS pour yummyrecipesforme.com.

Le serveur DNS répond avec l'adresse IP de greatrecipesforme.com.

Le navigateur lance une requête HTTP vers l'adresse IP de greatrecipesforme.com.

Un analyste principal confirme que le site web a été compromis. L'analyste vérifie le code source du site web. Il remarque qu'un code JavaScript a été ajouté pour inviter les visiteurs du site à télécharger un fichier exécutable. L'analyse du fichier téléchargé révèle un script qui redirige les navigateurs des visiteurs de yummyrecipesforme.com vers greatrecipesforme.com.

L'équipe de cybersécurité rapporte que le serveur Web a été impacté par une attaque par force brute. Le pirate mécontent a pu deviner facilement le mot de passe car le mot de passe administrateur était toujours défini sur le mot de passe par défaut. En outre, aucun contrôle n'a été mis en place pour empêcher une attaque par force brute.

Votre tâche consiste à documenter l'incident en détail, notamment en identifiant les protocoles réseau utilisés pour établir la connexion entre l'utilisateur et le site web. Vous devez également recommander une mesure de sécurité à prendre pour prévenir les attaques par force brute à l'avenir.
